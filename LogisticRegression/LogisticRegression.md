# Logistic Regression

[LogisticRegression 참고한 블로그](https://hwanny-yy.tistory.com/20)



**Logistic Regression이란?**

데이터가 어떤 범주에 속할 확률을 0에서 1 사이의 값으로 예측하고 그 확률에 따라 가능성이 더 높은 범주에 속하는 것으로 분류해 주는 지도 학습 알고리즘

쉽게 이야기하면, 선형회귀분석과 비슷한데 Y값이 확률로 되어 있기 때문에, [0,1]사이로 하한 상한이 정해져 있음.

또 특정 threshold 값을 기준으로 삼아서 예측된 확률 값이 threshold 이상인 것과 미만인 것으로 분류를 하는 식. 




**즉 1개 이상의 독립변수가 있을 때  이를 이용하여 데이터가 2개의 범주 중 하나에 속하도록 결정하는 이진분류 문제를 풀 때 로지스티 회귀분석을 많이 사용함.** 

만일 종속변수가 0일 확률을 $P(y=0|x)$라고 한다면, 이를 구하는 식은 아래와 같음.


$$
LogOdds = log 
(\frac{P(y=0|x)}{1/−P(y=0|x)})=β_0+\sum^P_{j=1}β_jx_j 
$$



Odds라는 개념은 사건이 발생할 확률을 발생하지 않을 확률로 나눈 값. 



유방암 데이터셋에 맞추어 설명한다면, 만일 악성 종양일 확률이 0.2라면 양성 종양일 확률이 자연스럽게 0.8이 됨.



$$
Odds(Malignant) = log 
(\frac{P(y=0|x)}{P(y=1|x)})=(\frac{P(y=0|x)}{1- P(y=0|x)})=\frac{0.2}{0.8} = 0.25 
$$



여기에 Log를 취한 값을 Log-odds라고 부름. 따라서 log-odds라는 값을 선형회귀분석의 종속변수처럼 구하면 됨.



$$
log 
(\frac{P(y=0|x)}{1/−P(y=0|x)})=log(0.25) =β_0+\sum^P_{j=1}β_jx_j 
$$



위의 식에 주어진 데이터를 이용하면, 주어진 데이터를 잘 설명하는 회귀계수 값을 구할 수 있음. 이렇게 로지스틱 회귀모델이 구성되는데, 회귀모델은 수식적으로 볼 때 Log-odds의 선형 회귀모델이라고 할 수 있음.

하지만 우리가 실제 원하는 값은 log-odds값이 아님.

우리는 종속변수가 0일 확률, 1일 확률 자체를 원하는 것이지 log-odds 자체의 값이 필요하지는 않음. 

그래서 log-odds로부터 특정 범주에 속할 확률을 얻기 위해 log-odds의 식을  $P(y=0|x)$에 대해서 다시 정리하면,



$$
P(y=0|x) = \frac{ exp(β_0+∑^p_{j=1}β_jx_j)}{1+exp(β_0+∑^p_{j=1}β_jx_j)}
$$



위와 같은 식을 얻게 됨. $z= β_0+\sum^P_{j=1}β_jx_j$라고 한다면, 식은 보다 간결하게 표현 됨.



$$
P(y=0|x) = \frac{1}{1+exp(-z)}
$$



결국 Log-odds 값을 구한 다음, 이를 sigmoid function에 넣어서 0에서 1 사이의 값으로 변환해 주는 것임.




이 함수는 확률 모델을 선형회귀모델로 표현한것이 아니라, z=0인 지점을 중심으로해서 두 범주 간 경계가 불명확해지는 x의 구간을 최소화 해 주기 때문에 분류모델의 분류 성능을 매우 향상시켜줌.




정리하면, 로지스틱 회귀에서는 데이터가 특정 범주에 속할 확률을 예측하기 위해 아래와 같은 단계를 거침.

1. 실제 데이터를 대입하여 Odds 및 회귀계수를 구함
2. Log-odds를 계산한 후, 이를 sigmoid function의 입력으로 넣어서 특정 범주에 속할 확률값을 계산
3. 설정한 threshold에 맞추어 설정값 이상이면 1, 이하면 0으로 이진분류를 수행함.
